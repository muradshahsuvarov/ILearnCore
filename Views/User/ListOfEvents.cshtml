@model List<ILearnCoreV19.Areas.Identity.Data.ApplicationEvent>

@{
    ViewData["Title"] = "ListOfEvents";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


@using Microsoft.AspNetCore.Http;


@{

}

<table class="table">
    <tr>
        <th>
            text
        </th>
        <th>
            start_date
        </th>
        <th>
            end_date
        </th>
        <th></th>
    </tr>

    @foreach (var item in Model)
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.text)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.start_date)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.end_date)
            </td>
            <td>
                <form asp-controller="User"
                      asp-action="Subscribe"
                      data-ajax-complete=""
                      data-ajax-failure="alert('Fail')"
                      data-ajax-success="sendSubsNotif"
                      data-ajax="true"
                      data-ajax-method="POST">

                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

                    <div class="form-group">
                        <input type="submit" value="Subscribe" class="btn btn-success" style="width:200px" />
                    </div>


                    <input type="hidden" name="userName" value=@item.userId />
                    <input type="hidden" name="eventId" value=@item.EventId />
                    <input type="hidden" name="email" value=@User.Identity.Name />
                    <input type="hidden" name="returnUrl" value="/User/ListOfEvents" />

                </form>
            </td>
        </tr>
    }
</table>


@section scripts {
    <script src="~/signalr/signalr.min.js"></script>
    <script src="~/lib/jquery/dist/jquery-unobtrusive-ajax.min.js"></script>
    <script src="~/js/chat.js"></script>
    <script src="~/js/signrReqHandler.js"></script>
}